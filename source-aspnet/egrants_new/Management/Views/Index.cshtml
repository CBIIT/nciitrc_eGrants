@{
    ViewBag.Title = "egrants [QC Assignment]";
    Layout = "~/Shared/Views/_egrants_header.cshtml";
}

<script language="javascript">

    var currenturl = window.document.location.href;

    function to_assign() {
        if (document.getElementById("ddlQCreason").selectedIndex == 0) {
            alert("Please select QC reason to assign");
            return false;
        } else var qc_reason = document.getElementById("ddlQCreason").options[document.getElementById("ddlQCreason").selectedIndex].text;

        if (document.getElementById("ddlQCperson").selectedIndex == 0) {
            alert("Please select QC person to assign");
            return false;
        } else  var qc_person = document.getElementById("ddlQCperson").options[document.getElementById("ddlQCperson").selectedIndex].text;
                var qc_person_id = document.getElementById("ddlQCperson").options[document.getElementById("ddlQCperson").selectedIndex].value;

        if (confirm('Are you sure that you want to assign QC ' + qc_reason + ' documents to ' + qc_person + '?')) {
            var url = "@Url.Action("To_Assign", "Management")?qc_reason=" + qc_reason + "&qc_person_id=" + qc_person_id;
            window.location.href = url;
        }
    }

    function to_remove(qc_reason, qc_person_id, person_name) {
        if (confirm('Are you sure that you want to remove '+ person_name +' from list for QC ' + qc_reason + ' documents?')) {
            var url = "@Url.Action("To_Remove", "Management")?qc_reason=" + qc_reason + "&qc_person_id=" + qc_person_id;
            window.location.href = url;
        }
    }

    function to_route() {
        if (document.getElementById("ddlFromPerson").selectedIndex == 0) {
            alert("Please select the person whose documents will be route out");
            return false;
        } else  var person = document.getElementById("ddlFromPerson").options[document.getElementById("ddlFromPerson").selectedIndex].text;
                var person_id = document.getElementById("ddlFromPerson").options[document.getElementById("ddlFromPerson").selectedIndex].value;

        if (document.getElementById("ddlPercent").selectedIndex == 0) {
                alert("Please select the percent of documents to route");
                return false;
        } else var percent = document.getElementById("ddlPercent").options[document.getElementById("ddlPercent").selectedIndex].value;

        if (document.getElementById("ddlToPerson").selectedIndex == 0) {
            alert("Please select the person whom documents will route to");
            return false;
        } else  var qc_person = document.getElementById("ddlToPerson").options[document.getElementById("ddlToPerson").selectedIndex].text;
                var qc_person_id = document.getElementById("ddlToPerson").options[document.getElementById("ddlToPerson").selectedIndex].value;

        if (confirm('Are you sure that you want to route ' + percent + '%  QC documents from ' + person + ' to ' + qc_person + '?')) {
            var url = "@Url.Action("To_Route", "Management")?person_id=" + person_id + "&percent=" + percent + "&qc_person_id=" + qc_person_id;
            window.location.href = url;
        }
    }
</script>

<div id="main">
    <!--start main-->
    <div style="text-align:left">
        <!--start sub link-->
        @Html.ActionLink("QC Assignment Report", "index", "Management", new { area = "Management" }, null)&#0160;&#47;
        @Html.ActionLink("Document Transaction Report", "index", "DocTransactionReport", new { area = "Management" }, null)&#0160;&#47;
        @Html.ActionLink("System Report", "index", "SystemReport", new { area = "Management" }, null)
    </div>
    <div id="caption"><b id="page_title">QC Assignment Report</b></div>
    <br />
    <div id="report" class="form-inline">
        <table id="modify">
            <thead>
                <tr style="height:30px">
                    <td colspan="3" style="vertical-align:central">* Select QC reason and assign it to particular specialist.</td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td width="350">
                        <label id="lblReason"><b>QC Reason:</b></label>&#0160;&#0160;
                        <select name="qc_reason" id="ddlQCreason" class="form-control" style="width:150px; height:30px;" size="1" title="Select a qc reason from list">
                            <option></option>
                            @foreach (var item in ViewBag.QCReasons)
                            {
                                <option value=@item.qc_reason>
                                    @item.qc_reason
                                </option>
                            }
                        </select>
                    </td>
                    <td width="450">
                        <label id="lblReason"><b>QC Person:</b></label>&#0160;&#0160;
                        <select name="qc_person_id" id="ddlQCperson" class="form-control" style="width:250px; height:30px;" size="1" title="Select a qc person from list">
                            <option></option>
                            @foreach (var item in ViewBag.Specialists)
                            {
                                <option value=@item.person_id>
                                    @item.person_name
                                </option>
                            }
                        </select>
                    </td>
                    <td width="100">
                        <button AccessKey="A" ID="btnAssign" class="btn btn-primary btn-sm" title="Click to add person for QC [shift + alt + A]" OnClick="to_assign();">
                            <U>A</U>ssign
                        </button>
                    </td>
                </tr>
                @foreach (var item in ViewBag.QCPersons)
                {
                    <tr style="height:20px">
                        <td>@item.qc_reason:</td>
                        <td>@item.person_name</td>
                        <td>
                            <a title="clcik it to remove" href="JavaScript:to_remove('@item.qc_reason', '@item.person_id','@item.person_name')">
                                Remove
                            </a>
                        </td>
                    </tr>
                }
                <tr style="height:30px"><td colspan="3"></td></tr>
            </tbody>
        </table>
    </div>

    <div id="caption"><b id="page_title">QC Route Report</b></div>
    <br />
    <div id="report" class="form-inline">
        <table id="modify">
            <thead>
                <tr style="height:30px">
                    <td colspan="3" style="vertical-align:central">* Select specialist name and percent of documents,  route them to another specialist for QC.</td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td width="350">
                        <label id="lblFrom"><b>From:</b></label>
                        <select name="person_id" id="ddlFromPerson" class="form-control" style="width:200px; height:30px;" size="1" title="Select a qc person from list">
                            <option></option>
                            @foreach (var item in ViewBag.Specialists)
                            {
                                <option value=@item.person_id>@item.person_name</option>
                            }
                        </select>
                    </td>
                    <td width="500">
                        <label id="lblTo"><b>To:</b></label>&#0160;&#0160;
                        <select name="qc_person_id" id="ddlToPerson" class="form-control" style="width:200px; height:30px;" size="1" title="Select a qc person from list">
                            <option></option>
                            @foreach (var item in ViewBag.Specialists)
                            {
                                <option value=@item.person_id>@item.person_name</option>
                            }
                        </select>
                        <select name="percent" id="ddlPercent" class="form-control" style="width:80px; height:30px;" title="Select percent">
                            <option></option>
                            <option Value="100">100%</option>
                            <option Value="50">50%</option>
                            <option Value="25">25%</option>
                            <option Value="10">10%</option>
                        </select>
                    </td>
                    <td width="100">
                        <button AccessKey="R" ID="btnRoute" class="btn btn-primary btn-sm" title="Click to route [shift + alt + R]" OnClick="to_route();">
                            <U>R</U>oute
                        </button>
                    </td>
                </tr>
                <tr style="height:30px">
                    <td><b>Specialist Name</b></td>
                    <td><b>Documents to QC</b></td>
                    <td><b>Days in</b></td>
                </tr>
                @foreach (var item in ViewBag.QCReport)
                {
                    <tr style="height:20px">
                        <td>@item.qc_person_name</td>
                        <td>@item.files_to_qc</td>
                        <td>@item.qc_days</td>
                    </tr>
                }
                <tr style="height:30px"><td colspan="2"></td></tr>
            </tbody>
        </table>
    </div>
</div><!--end main-->
